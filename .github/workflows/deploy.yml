name: Test SSH Key

on:
  push:
    branches:
      - main

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Test SSH key
        env:
          SSH_PRIVATE_KEY: ${{ secrets.WP_SECRET }}
        run: |
          # Показать первые 50 символов секрета (для проверки формата)
          echo "Первые 50 символов секрета:"
          echo "$SSH_PRIVATE_KEY" | head -c 50
          echo ""
          
          # Сохранить ключ
          echo "$SSH_PRIVATE_KEY" > test_key
          
          # Проверить количество строк
          echo "Количество строк в ключе:"
          wc -l test_key
          
          # Проверить формат
          echo "Первая строка:"
          head -n 1 test_key
          
          # Попробовать прочитать ключ
          echo "Попытка прочитать ключ:"
          ssh-keygen -y -f test_key || echo "Не удалось прочитать ключ"